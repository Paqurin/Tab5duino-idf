; ESP32-P4 Configuration Template for Tab5duino-IDF Library
; Copy this configuration to your project's platformio.ini for ESP32-P4 compatibility

[env:m5tab5_esp32p4]
platform = espressif32@^6.5.0
board = esp32dev
framework = arduino

; Monitor configuration
monitor_speed = 115200
monitor_port = /dev/ttyACM*
monitor_filters = 
    esp32_exception_decoder
    time

; ESP32-P4 specific build flags
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    -DLOG_DEFAULT_LEVEL=3
    -DARDUINO_USB_CDC_ON_BOOT=0
    -DARDUINO_SERIAL_EVENT_RUN_DISABLED=1
    -DCONFIG_ARDUHAL_ESP_LOG=1
    -DLED_BUILTIN=2
    -DBOARD_HAS_PSRAM=1
    -DESP32_P4=1
    -DARDUINO_M5TAB5=1
    -DPSRAM_SIZE_MB=32
    -DFLASH_SIZE_MB=16
    -O2
    -ffunction-sections
    -fdata-sections
    -Wl,--gc-sections

; ESP32-P4 board definitions
board_build.partitions = default_16MB.csv
board_build.filesystem = fatfs
board_build.flash_mode = qio
board_build.f_cpu = 400000000L
board_build.f_flash = 80000000L
board_build.mcu = esp32

; Upload configuration for ESP32-P4
upload_speed = 460800
upload_protocol = esptool

; Tab5duino-IDF library
lib_deps = 
    https://github.com/Paqurin/Tab5duino-idf.git

; Custom upload script for ESP32-P4 compatibility
upload_flags =
    --chip=esp32p4
    --flash_mode=qio
    --flash_freq=80m 
    --flash_size=16MB

; Development tools
check_tool = cppcheck
check_flags = 
    cppcheck: --enable=all --inline-suppr