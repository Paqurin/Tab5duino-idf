[env:m5tab5]
platform = espressif32
board = esp32-p4-function-ev-board
framework = arduino

; Use Tab5duino framework
platform_packages = 
    framework-tab5duino@file://../../../

; Build configuration for ESP32-P4 with high performance
build_flags = 
    -DARDUINO_M5STACK_TAB5
    -DESP32_P4_HIGH_PERFORMANCE=1
    -DPSRAM_SIZE_MB=32
    -DLVGL_ENABLED=1
    -Os
    -ffunction-sections
    -fdata-sections
    
; Linker flags for optimization
build_unflags = 
    -O2

link_flags = 
    -Wl,--gc-sections

; Memory configuration
board_build.partitions = huge_app.csv
board_build.filesystem = littlefs

; Upload configuration
upload_speed = 921600
monitor_speed = 115200
monitor_filters = esp32_exception_decoder

; Libraries
lib_deps = 
    LVGL@^8.4.0

; Advanced configuration
board_build.f_cpu = 400000000L
board_build.f_flash = 80000000L
board_build.flash_mode = qio

; ESP-IDF specific
board_build.embed_files = 

; Debug configuration
debug_tool = esp-builtin
debug_init_break = tbreak setup

; Custom build script for LVGL integration
extra_scripts = 
    pre:scripts/pre_build.py